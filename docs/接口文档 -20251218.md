ä¸‹é¢æ˜¯**åŸºäºä½ ç»™å‡ºçš„ FastAPI ä»£ç **æ•´ç†ç”Ÿæˆçš„ **ã€Šæ™ºèƒ½ä½“ç®¡ç†æ¥å£æ–‡æ¡£ï¼ˆAPI Docï¼‰ã€‹**ï¼Œé‡‡ç”¨ **Markdown æ ‡å‡†æ¥å£æ–‡æ¡£é£æ ¼**ï¼Œå¯ç›´æ¥ç”¨äºï¼š

* å‰ç«¯è”è°ƒ
* æ¥å£æµ‹è¯•ï¼ˆPostman / Apifoxï¼‰
* é¡¹ç›® README / æ¥å£è¯´æ˜æ–‡æ¡£

---

# ğŸ¤– æ™ºèƒ½ä½“ç®¡ç†æ¥å£æ–‡æ¡£ï¼ˆAgents APIï¼‰

## åŸºç¡€ä¿¡æ¯

* **æ¥å£å‰ç¼€**ï¼š`/agents`
* **æ•°æ®æ ¼å¼**ï¼š`application/json`
* **æµå¼æ¥å£åè®®**ï¼š`Server-Sent Events (SSE)`
* **ç»Ÿä¸€å“åº”æ¨¡å‹**ï¼š`APIResponse`

---

## ä¸€ã€é€šç”¨å“åº”ç»“æ„

```json
{
  "success": true,
  "data": {},
  "error": null
}
```

| å­—æ®µ      | ç±»å‹      | è¯´æ˜        |
| ------- | ------- | --------- |
| success | boolean | æ˜¯å¦æˆåŠŸ      |
| data    | object  | è¿”å›æ•°æ®      |
| error   | string  | é”™è¯¯ä¿¡æ¯ï¼ˆå¤±è´¥æ—¶ï¼‰ |

---

## äºŒã€æ™ºèƒ½ä½“æ¨¡æ¿ç›¸å…³æ¥å£

### 1ï¸âƒ£ è·å–æ™ºèƒ½ä½“æ¨¡æ¿åˆ—è¡¨

**æ¥å£åœ°å€**

```
GET /agents/templates/list
```

**è¿”å›ç¤ºä¾‹**

```json
[
  {
    "template_id": "template_001",
    "template_name": "é‡å­é”€å”®ç»ç†",
    "description": "è´Ÿè´£é”€å”®å’¨è¯¢çš„æ™ºèƒ½ä½“"
  }
]
```

**å­—æ®µè¯´æ˜**

| å­—æ®µ            | è¯´æ˜   |
| ------------- | ---- |
| template_id   | æ¨¡æ¿ID |
| template_name | æ¨¡æ¿åç§° |
| description   | æ¨¡æ¿æè¿° |

---

## ä¸‰ã€æ™ºèƒ½ä½“å®ä¾‹ç®¡ç†

### 2ï¸âƒ£ è·å–æ™ºèƒ½ä½“å®ä¾‹åˆ—è¡¨

**æ¥å£åœ°å€**

```
GET /agents/instance/list
```

**è¿”å›ç¤ºä¾‹**

```json
[
  {
    "id": "agent_xxx",
    "name": "é‡å­é”€å”®ç»ç†",
    "type": "sales",
    "description": "é‡å­é”€å”®ç»ç†æ™ºèƒ½ä½“",
    "is_active": true,
    "is_speaking": false,
    "run_time": "RUNNING",
    "cognitive_state": "IDLE"
  }
]
```

---

### 3ï¸âƒ£ åˆ›å»ºæ™ºèƒ½ä½“å®ä¾‹

**æ¥å£åœ°å€**

```
POST /agents/create
```

**è¯·æ±‚å‚æ•°**

```json
{
  "agent_config_id": 1
}
```

| å‚æ•°              | ç±»å‹  | å¿…å¡« | è¯´æ˜           |
| --------------- | --- | -- | ------------ |
| agent_config_id | int | æ˜¯  | æ™ºèƒ½ä½“é…ç½®IDï¼ˆæ•°æ®åº“ï¼‰ |

**è¿”å›ç¤ºä¾‹**

```json
{
  "success": true,
  "data": {
    "id": "agent_xxx",
    "name": "é‡å­é”€å”®ç»ç†",
    "type": "sales",
    "description": "é”€å”®æ™ºèƒ½ä½“",
    "is_active": false,
    "is_speaking": false
  }
}
```

---

### 4ï¸âƒ£ è·å–æ‰€æœ‰æ™ºèƒ½ä½“ ID åˆ—è¡¨

**æ¥å£åœ°å€**

```
GET /agents/list
```

**è¿”å›ç¤ºä¾‹**

```json
{
  "success": true,
  "data": {
    "agents": ["agent_1", "agent_2"]
  }
}
```

---

## å››ã€æ¶ˆæ¯äº¤äº’æ¥å£

### 5ï¸âƒ£ å‘é€æ¶ˆæ¯ï¼ˆéæµå¼ï¼‰

**æ¥å£åœ°å€**

```
POST /agents/{agent_id}/message
```

**è¯·æ±‚å‚æ•°**

```json
{
  "message": "ä½ å¥½",
  "session_id": "session_001"
}
```

| å‚æ•°         | ç±»å‹     | å¿…å¡« | è¯´æ˜   |
| ---------- | ------ | -- | ---- |
| message    | string | æ˜¯  | ç”¨æˆ·è¾“å…¥ |
| session_id | string | å¦  | ä¼šè¯ID |

**è¿”å›ç¤ºä¾‹**

```json
{
  "success": true,
  "data": {
    "response": "ä½ å¥½ï¼Œæˆ‘æ˜¯é‡å­é”€å”®ç»ç†",
    "session_id": "session_001",
    "processing_time": 0.82
  }
}
```

---

### 6ï¸âƒ£ æµå¼èŠå¤©æ¥å£ï¼ˆSSEï¼‰

**æ¥å£åœ°å€**

```
POST /agents/{agent_id}/stream
```

**è¯·æ±‚å‚æ•°**

```json
{
  "message": "å¸®æˆ‘åˆ†æå®¢æˆ·æƒ…å†µ",
  "session_id": "session_001"
}
```

**äº‹ä»¶ç±»å‹è¯´æ˜**

| type         | è¯´æ˜   |
| ------------ | ---- |
| stream_start | æµå¼€å§‹  |
| chunk        | å†…å®¹ç‰‡æ®µ |
| stream_end   | æµç»“æŸ  |
| error        | é”™è¯¯äº‹ä»¶ |

**SSE ç¤ºä¾‹**

```text
data: {"type":"stream_start","session_id":"session_001"}

data: {"type":"chunk","content":"å®¢æˆ·ç›®å‰"}

data: {"type":"chunk","content":"å¤„äºè·Ÿè¿›é˜¶æ®µ"}

data: {"type":"stream_end","session_id":"session_001"}
```

---

## äº”ã€æ™ºèƒ½ä½“çŠ¶æ€æ§åˆ¶

### 7ï¸âƒ£ è·å–æ™ºèƒ½ä½“ä¿¡æ¯ / å¥åº·çŠ¶æ€

**æ¥å£åœ°å€**

```
GET /agents/{agent_id}/info
```

**è¿”å›ç¤ºä¾‹**

```json
{
  "success": true,
  "data": {
    "status": "healthy",
    "memory_usage": "normal",
    "latency": 120
  }
}
```

---

### 8ï¸âƒ£ åˆ‡æ¢å½“å‰æ´»è·ƒæ™ºèƒ½ä½“

**æ¥å£åœ°å€**

```
POST /agents/activate
```

**è¯·æ±‚å‚æ•°**

```json
{
  "agent_id": "agent_001"
}
```

**è¿”å›ç¤ºä¾‹**

```json
{
  "success": true,
  "data": {
    "agents": ["agent_001", "agent_002"],
    "current_activate": "agent_001"
  }
}
```

---

### 9ï¸âƒ£ å…³é—­æŒ‡å®šæ™ºèƒ½ä½“

**æ¥å£åœ°å€**

```
POST /agents/{agent_id}/close
```

**è¿”å›ç¤ºä¾‹**

```json
{
  "success": true
}
```

---

## å…­ã€è¡¥å……è¯´æ˜

* æµå¼æ¥å£é€‚ç”¨äº **å¯¹è¯æ¡†é€å­—æ¸²æŸ“**
* `session_id` ç”¨äºå¤šè½®å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†
* æ”¯æŒåŒæ—¶å­˜åœ¨å¤šä¸ªæ™ºèƒ½ä½“å®ä¾‹
* æ¿€æ´»æ€æ™ºèƒ½ä½“ç”¨äºé»˜è®¤äº¤äº’è·¯ç”±

---

ğŸ“Œ **æ¨èç”¨é€”**ï¼š

* å‰ç«¯èŠå¤©çª—å£
* Agent ç®¡ç†æ§åˆ¶å°
* å¤šæ™ºèƒ½ä½“åä½œç³»ç»Ÿ

---

**ä½ å¯ä»¥å‘Šè¯‰æˆ‘ï¼š**

* **æ˜¯å¦è¦æ‹†æˆ OpenAPI / Apifox / Swagger é£æ ¼ï¼Ÿ**
* **æ˜¯å¦éœ€è¦æˆ‘å¸®ä½ ç”Ÿæˆå‰ç«¯ Axios / fetch è°ƒç”¨ç¤ºä¾‹ï¼Ÿ**
* **æ˜¯å¦è¦è¡¥ä¸€å¼ â€œæ™ºèƒ½ä½“ç”Ÿå‘½å‘¨æœŸ & çŠ¶æ€æµè½¬å›¾â€ï¼Ÿ**
